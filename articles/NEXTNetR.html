<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Basic Simulations of Epidemics • NEXTNetR</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Basic Simulations of Epidemics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NEXTNetR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/NEXTNetR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/custom_time_distributions_cpp.html">Custom time distributions (using C++)</a></li>
    <li><a class="dropdown-item" href="../articles/custom_time_distributions_r.html">Custom time distributions (using pure R)</a></li>
    <li><a class="dropdown-item" href="../articles/empirical_networks.html">Empirical Networks</a></li>
    <li><a class="dropdown-item" href="../articles/spatial_temporal_networks.html">Spatial and Temporal Networks</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/oist/NEXTNetR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Basic Simulations of Epidemics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/oist/NEXTNetR/blob/master/vignettes/NEXTNetR.Rmd" class="external-link"><code>vignettes/NEXTNetR.Rmd</code></a></small>
      <div class="d-none name"><code>NEXTNetR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="loading-the-nextnetr-package">Loading the NEXTNetR package<a class="anchor" aria-label="anchor" href="#loading-the-nextnetr-package"></a>
</h2>
<p>We start with loading the <a href="https://oist.github.io/NEXTNetR/">NEXTNetR</a> package. If the
package is not already installed, see the <a href="https://oist.github.io/NEXTNetR/">website</a> for installation
instructions. We also load the <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> and
<a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a> packages for plotting and set a nice theme.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://oist.github.io/NEXTNetR/">NEXTNetR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-and-inspecting-networks">Creating and inspecting networks<a class="anchor" aria-label="anchor" href="#creating-and-inspecting-networks"></a>
</h2>
<p>Next we create a network object. To see the full list of network
types supported by <a href="https://oist.github.io/NEXTNetR/">NEXTNetR</a>, type
<code><a href="../reference/network_types.html">help(network_types)</a></code>. Here, we create a random Erdős–Rényi
network of a given <code>size</code>, i.e. with a given number of nodes.
On Erdős–Rényi networks, each possible link has an probability to exist
independent of all other links. This probability is computed such that
nodes have the specified average degree (i.e. number of neighbours).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/erdos_renyi_network.html">erdos_renyi_network</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1e5</span>, avg_degree<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>The object <code>nw</code> now represents a specific network. We can
inspect the network using the functions listed in
<code><a href="../reference/network_properties.html">help(network_properties)</a></code>. For example, we can query the
number of neighbours of node 371 with</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">degree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/network_properties.html">network_outdegree</a></span><span class="op">(</span><span class="va">nw</span>, <span class="fl">371</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">degree</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<p>and knowing the degree we can query all neighbours of node 371.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/network_properties.html">network_neighbour</a></span><span class="op">(</span><span class="va">nw</span>, <span class="fl">371</span>, <span class="fl">1</span><span class="op">:</span><span class="va">degree</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 18386 32383 63810 66115 83635 88963</span></span></code></pre></div>
<p>Most inspection functions are vectorized and can query multiple nodes
at once. For example, to plot the degree distribution as a histogram and
compare it with the theoretically predicted Poisson distribution (dashed
blue line) we can simply do</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/network_properties.html">network_size</a></span><span class="op">(</span><span class="va">nw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>degree<span class="op">=</span><span class="fu"><a href="../reference/network_properties.html">network_outdegree</a></span><span class="op">(</span><span class="va">nw</span>, <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">degree</span>, y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 binwidth<span class="op">=</span><span class="fl">1</span>, fill<span class="op">=</span><span class="st">'darkgrey'</span>, color<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="va">N</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                n<span class="op">=</span><span class="fl">1000</span>, color<span class="op">=</span><span class="st">'blue'</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, linewidth<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="NEXTNetR_files/figure-html/plot_degrees-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="creating-and-inspecting-time-distributions">Creating and inspecting time distributions<a class="anchor" aria-label="anchor" href="#creating-and-inspecting-time-distributions"></a>
</h2>
<p>Before we can start a simulation, we next have to create time
distributions which represent the time it takes to transmit the disease
across a link, and for the time it takes for an infected node to
recover. We chose a log-normal distribution for the infection. By
specifying <code>p_infinity = 0.1</code>, we modify the infection time
distribution to produce an infinite infection time (i.e. no actual
infection) in 10% of cases; this means that neighbours of an infected
node only have a 90% chance of becoming infected eventually.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infection_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/time_distributions.html">lognormal_time</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fl">6</span>, var<span class="op">=</span><span class="fl">30</span>, p_infinity <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p>While time distribution objects are mainly useful for epidemic
simulations, they can also be used similed to R’s built-in random
distributions, see <code><a href="../reference/time_functions.html">help(time_functions)</a></code>. We can, for
example, plot the distribution’s density and survival function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">lims</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">'time'</span>, y<span class="op">=</span><span class="st">'density'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">time_density</span>, n<span class="op">=</span><span class="fl">1000</span>,</span>
<span>                  args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>timedistribution<span class="op">=</span><span class="va">infection_time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">lims</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">'time'</span>, y<span class="op">=</span><span class="st">'survival'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">time_survivalprobability</span>, n<span class="op">=</span><span class="fl">1000</span>,</span>
<span>                  args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>timedistribution<span class="op">=</span><span class="va">infection_time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ncol<span class="op">=</span><span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="NEXTNetR_files/figure-html/plot_density-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="creating-and-running-simulations">Creating and running simulations<a class="anchor" aria-label="anchor" href="#creating-and-running-simulations"></a>
</h2>
<p>To run a simulation, we now create a simulation object which binds
together the network and the infection time distribution we created
above</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulation.html">simulation</a></span><span class="op">(</span>nw<span class="op">=</span><span class="va">nw</span>, psi<span class="op">=</span><span class="va">infection_time</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we add an initial infection to get the epidemic going</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/simulation_functions.html">simulation_addinfections</a></span><span class="op">(</span><span class="va">sim</span>, nodes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>and start the simulation, telling it to run until either time 100 or
until 50,000 nodes have been infected.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulation_run.html">simulation_run</a></span><span class="op">(</span><span class="va">sim</span>, stop<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time<span class="op">=</span><span class="fl">100</span>, total_infected<span class="op">=</span><span class="fl">50e3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Running a simulation returns a <code>data.frame</code> listing all
the events that occurred. We can use this to plot the size of the
epidemic over time.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">events</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">infected</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="NEXTNetR_files/figure-html/plot_trajectory_initial-1.png" width="700"></p>
<p>Simulations can be continued by calling <code>simulation_run</code>
again. To continue the simulation until time 50, we do</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">events2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulation_run.html">simulation_run</a></span><span class="op">(</span><span class="va">sim</span>, stop<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time<span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To plot the full trajectory, we must combine the events reported by
the first call of <code>simulation_run</code> with the events reported
by the second call,</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">events</span>, <span class="va">events2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">infected</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="NEXTNetR_files/figure-html/plot_trajectory_full-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="adding-a-recovery-or-reset-time">Adding a recovery (or reset) time<a class="anchor" aria-label="anchor" href="#adding-a-recovery-or-reset-time"></a>
</h2>
<p>In our previous simulation, nodes who were infected stayed infected
indefinitely. We now add a recovery time so that nodes eventually return
to their original state. Note that <em>recovery</em> here also implies
that nodes become susceptible to reinfection; a better term may
therefore be <em>reset</em>. For the recovery time distribution, we pick
a weibull distribution</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recovery_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/time_distributions.html">weibull_time</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">5</span>, scale<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">lims</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">'time'</span>, y<span class="op">=</span><span class="st">'density'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">time_density</span>,</span>
<span>                args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>timedistribution<span class="op">=</span><span class="va">recovery_time</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="NEXTNetR_files/figure-html/plot_density_recovery-1.png" width="700"></p>
<p>To run the simulation, we again create a simulation object, this time
specifying the recovery time through the <code>rho</code> parameter. The
trajectory now shows a wave-like pattern</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulation.html">simulation</a></span><span class="op">(</span>nw<span class="op">=</span><span class="va">nw</span>, psi<span class="op">=</span><span class="va">infection_time</span>, rho<span class="op">=</span><span class="va">recovery_time</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/simulation_functions.html">simulation_addinfections</a></span><span class="op">(</span><span class="va">sim</span>, nodes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulation_run.html">simulation_run</a></span><span class="op">(</span><span class="va">sim</span>, stop<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time<span class="op">=</span><span class="fl">300</span>, total_infected<span class="op">=</span><span class="fl">300e3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">events</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">infected</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="NEXTNetR_files/figure-html/plot_trajectory_recovery-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Florian Pflug, Samuel Cure.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
